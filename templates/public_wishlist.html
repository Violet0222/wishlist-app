{% extends "public_base.html" %} {% block title %} Wishlist{% endblock %} {%
block head %} <link rel="stylesheet" href="/static/css/styles.css" /> {#
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø—É–±–ª–∏—á–Ω–æ #}
<style>
  /* –î–æ–±–∞–≤—å—Ç–µ —Å—é–¥–∞ –∏–ª–∏ –≤ styles.css —Å—Ç–∏–ª–∏, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã */
  .public-wishlist-table .table-cell {
    padding: 8px;
    border-bottom: 1px solid #eee;
    vertical-align: top;
    text-align: left;
  }

  .public-wishlist-table .table-row:last-child .table-cell {
    border-bottom: none;
  }

  .public-wishlist-table .table-header {
    font-weight: bold;
    background-color: #f9f9f9;
  }

  .public-wishlist-table .image-cell img {
    max-width: 80px; /* –£–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ */
    height: auto;
    display: block;
    margin: 0 auto; /* –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è */
  }

  .public-wishlist-table .status-reserved {
    color: green;
    font-weight: bold;
  }

  .public-wishlist-table .status-not-reserved {
    color: orange;
  }

  .reserve-form-container {
    margin-top: 5px;
    padding: 10px;
    background-color: #f0f0f0;
    border-radius: 5px;
    display: none; /* –°–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
  }

  .reserve-email-input {
    width: calc(100% - 70px); /* –®–∏—Ä–∏–Ω–∞ –ø–æ–ª—è –¥–ª—è –≤–≤–æ–¥–∞ email */
    padding: 5px;
    margin-right: 5px;
    border: 1px solid #ccc;
    border-radius: 3px;
  }

  .reserve-button {
    padding: 5px 10px;
    background-color: #4caf50; /* –ó–µ–ª–µ–Ω–∞—è –∫–Ω–æ–ø–∫–∞ */
    color: white;
    border: none;
    border-radius: 3px;
    cursor: pointer;
  }

  .reserve-button:hover {
    background-color: #45a049;
  }
</style>
<link rel="stylesheet" href="/static/css/modal_window.css" />
<script>
  document.addEventListener("DOMContentLoaded", function () {
    // –õ–æ–≥–∏–∫–∞ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è
    const openReserveModals = document.querySelectorAll(".openModalBtnReserve");

    openReserveModals.forEach((button) => {
      button.addEventListener("click", () => {
        const wishId = button.dataset.wishId; // –ü–æ–ª—É—á–∞–µ–º ID –∂–µ–ª–∞–Ω–∏—è –∏–∑ data-wish-id
        const modal = document.getElementById(`modalReserve-${wishId}`); // –ù–∞—Ö–æ–¥–∏–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –º–æ–¥–∞–ª–∫—É
        if (modal) {
          modal.classList.add("open"); // –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É
        }
      });
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ –∫–Ω–æ–ø–∫–µ –∑–∞–∫—Ä—ã—Ç–∏—è
    document.querySelectorAll(".closeModalBtnReserve").forEach((button) => {
      button.addEventListener("click", () => {
        const modal = button.closest(".modal-overlay"); // –ù–∞—Ö–æ–¥–∏–º –±–ª–∏–∂–∞–π—à–∏–π —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç —Å –∫–ª–∞—Å—Å–æ–º modal-overlay
        if (modal) {
          modal.classList.remove("open"); // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É
        }
      });
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ –∫–ª–∏–∫—É —Å–Ω–∞—Ä—É–∂–∏
    document.querySelectorAll(".modal-overlay").forEach((overlay) => {
      // –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —ç—Ç–æ –º–æ–¥–∞–ª–∫–∞ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è, –µ—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–æ–≤ –º–æ–¥–∞–ª–æ–∫
      if (overlay.id.startsWith("modalReserve-")) {
        overlay.addEventListener("click", (event) => {
          if (event.target === overlay) {
            // –ï—Å–ª–∏ –∫–ª–∏–∫ –±—ã–ª –ø–æ —Å–∞–º–æ–º—É –æ–≤–µ—Ä–ª–µ—é, –∞ –Ω–µ –ø–æ –µ–≥–æ –¥–æ—á–µ—Ä–Ω–∏–º —ç–ª–µ–º–µ–Ω—Ç–∞–º
            overlay.classList.remove("open"); // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É
          }
        });
      }
    });
  });
</script>
{% endblock %} {% block content %}
<div class="wishlist-wrapper">
  {# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—Ç –∂–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—â–∏–µ —Å—Ç–∏–ª–∏ #}
  <header class="wishlist-header">
    <h1>{{ list_name }}'s Wishlist üéÅ</h1>
    {# –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ list_name –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∏–∑ –≤–∞—à–µ–≥–æ Flask —Ä–æ—É—Ç–∞ #}
    <p>Take a look at what {{ list_owner }} is wishing for!</p>
    <p>
      If you'd like to reserve an item, click on its "Not reserved" status,
      enter your email, and confirm your reservation.
    </p>
    {# –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–ª–∞–¥–µ–ª–µ—Ü —Å–ø–∏—Å–∫–∞ #}
  </header>

  {% if wishes %}
  <div class="wishlist-table-container">
    <div class="table public-wishlist-table">
      <!-- Table Header for Public View -->
      <div class="table-row wishlist-header">
        <div class="table-cell status-cell">üìç Status</div>
        <div class="table-cell image-cell">üñºÔ∏è Image</div>
        <div class="table-cell title-cell">üìå Title</div>
        <div class="table-cell description-cell">üìù Description</div>
        <div class="table-cell price-cell">üí∞ Price</div>
        <div class="table-cell currency-cell">üí± Currency</div>
        <div class="table-cell priority-cell">‚≠ê Priority</div>
        <div class="table-cell">‚è≥ Wanted by</div>
        <div class="table-cell url-cell">üîó Link</div>
      </div>

      <!-- Table Rows -->
      {% for wish in wishes %}
      <div class="table-row">
        <div class="table-cell status-cell">
          {% if wish['reserved'] == 0 or wish['reserved'] is none %}
          <button
            class="status-label status-not-reserved reserve-btn-in-table openModalBtnReserve"
            data-wish-id="{{ wish.id }}"
          >
            Not reserved
          </button>
          {% else %}
          <span class="status-label status-reserved">Reserved!</span>
          {% endif %}
        </div>

        <!-- Image -->
        <div class="table-cell image-cell">
          {% if wish['image'] %}
          <img
            src="{{ url_for('static', filename='uploads/' ~ wish['image']) }}"
            alt="{{ wish['title'] }}"
          />
          {% else %}
          <span class="muted">No image</span>
          {% endif %}
        </div>

        <!-- Title -->
        <div class="table-cell title-cell">{{ wish['title'] }}</div>

        <!-- Description -->
        <div class="table-cell description-cell">
          {{ wish.description or '<span class="muted">No description</span>' |
          safe }}
        </div>

        <!-- Price -->
        <div class="table-cell price-cell">
          {{ wish.price or '<span class="muted">N/A</span>' | safe }}
        </div>

        <!-- Currency -->
        <div class="table-cell currency-cell">
          {{ wish.currency or '<span class="muted">N/A</span>' | safe }}
        </div>

        <!-- Priority -->
        <div class="table-cell priority-cell">
          {% if wish['priority'] == 0 %}Low{% endif %} {% if wish['priority'] ==
          1 %}Medium{% endif %} {% if wish['priority'] == 2 %}High{% endif %} {%
          if wish['priority'] is not defined or wish['priority'] is none %}<span
            class="muted"
            >N/A</span
          >{% endif %}
        </div>

        <!-- Wanted by -->
        <div class="table-cell wanted_by-cell">
          {{ wish.wanted_by or '<span class="muted">N/A</span>' | safe }}
        </div>

        <!-- URL -->
        <div class="table-cell url-cell">
          {% if wish.url %}
          <a href="{{ wish['url'] }}" target="_blank">View Link</a>
          {% else %}
          <span class="muted">No link</span>
          {% endif %}
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
  {% else %}
  <p>No wishes found in this list.</p>
  {% endif %}
</div>
{% for wish in wishes %} {% if not wish.reserved %}
<div id="modalReserve-{{ wish.id }}" class="modal-overlay">
  <div class="modal">
    <div class="modal-header">
      <h2>Reserve "{{ wish.title }}"</h2>
      <button class="closeModalBtnReserve modal-close">&times;</button>
    </div>
    <div class="modal-body">
      <p>Please enter your email to reserve this item:</p>
      <form
        action="{{ url_for('reserve_wish', wish_id=wish.id) }}"
        method="POST"
      >
        <input
          type="email"
          name="email"
          placeholder="Your email"
          required
          class="reserve-email-input"
        />
        <button type="submit" class="reserve-button">Reserve</button>
      </form>
    </div>
  </div>
</div>
{% endif %} {% endfor %} {% endblock %}
